<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>Crypt0 Cemetery (Alpha)</title>
  <link rel="stylesheet" type="text/css" href="style.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/web3/1.7.4-rc.1/web3.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/web3@1.5.2/dist/web3.min.js"></script>
</head>

<body id="cemetery">

  <p id="logo">
    crypt0_cemetery v0.8.0
  </p>

  <p id="about">
    <a href="/docs/FAQ.pdf" target="_blank">FAQ</a> &nbsp; &nbsp;
    <a href="/docs/singularity_en.pdf" target="_blank">white paper</a> &nbsp; &nbsp;
    <a href="https://twitter.com/GrandRisingCR" target="_blank">twitter</a>
  </p>

  <div id="navContainer" class="nav-container">
    <span id="gravenav"></span>
    <div>
      <div class="address-container">
        <p><span id="address"></span></p>
      </div>
      <div id="statusBar"></div>
    </div>
  </div>

  <div id="cemeteryContainer">
    <div id="modal" class="modal-style">
      <button id="closeModal" class="modal-close">X</button>
      <br><br><br>
      <text for="modalOccupant">Occupant:</text>
      <input type="text" id="modalOccupant" />
      <br><br>
      <text for="modalBirth">Birth:</text>
      <input type="date" id="modalBirth" />
      <br><br>
      <text for="modalEpitaph">Epitaph:</text>
      <input type="text" id="modalEpitaph" />
      <br><br>
      <text for="modalMediaUrl">Media:</text>
      <input type="text" id="modalMediaUrl" />
      <br>
      <text style="font-size:12px"><i>Media file must begin with "ipfs://".</i></text>
      <br><br>
      <text for="modalMetadata">Metadata:</text>
      <input type="text" id="modalMetadata" />
      <br>
      <text style="font-size:12px"><i>Metadata file must begin with "ipfs://".</i></text>
      <br><br>
      <!-- <text for="modalResurrectTime">Resurrection:</text>
      <input type="datetime-local" id="modalResurrectTime" />
      <br><br>
      <text for="modalBeneficiary">Beneficiary:</text>
      <input type="text" id="modalBeneficiary" />
      <br>
      <text style="font-size:12px"><i>Beneficiary must be an ethereum address (0x...)</i></text>
      <br><br>
      <br><br>
      <text style="color:#ffd000">â“˜ You will be asked to sign 2 transactions. The first transaction will bury your
        coffin. The second
        transaction gives the beneficiary approval to resurrect any of your coffins.</text>
      <br><br> -->
      <button id="submitModal">BURY</button>
    </div>
  </div>

  <div id="tokenDetailsModal" class="modal-style">
    <pre id="tokenDetails"></pre>
    <button id="closeDetailsModal" class="modal-close">X</button>
  </div>
  <script src="index.js"></script>

  <hr>



  <style>
    #drop_zone {
        border: 2px dashed #bbb;
        border-radius: 5px;
        width: 480px;
        height: 320px;
        padding: 32px;
        text-align: center;
        font-size: 24px;
        color: #bbb;
        background-color: #f0f0f0;
        margin: 32px auto;
    }
</style>
<script>
            function init() {
            const dropZone = document.getElementById('drop_zone');
            dropZone.addEventListener('dragover', handleDragOver, false);
            dropZone.addEventListener('drop', handleDrop, false);
        }

        function handleDragOver(event) {
            event.stopPropagation();
            event.preventDefault();
            event.dataTransfer.dropEffect = 'copy';
        }

        async function handleDrop(event) {
            event.stopPropagation();
            event.preventDefault();

            const file = event.dataTransfer.files[0];
            if (!file.type.startsWith('image/')) {
                alert('Please drop an image file.');
                return;
            }

            const buffer = await file.arrayBuffer();
            const url = 'https://api.pinata.cloud/pinning/pinFileToIPFS';
            const formData = new FormData();
            formData.append('file', new Blob([buffer], { type: file.type }));

            const response = await fetch(url, {
                method: 'POST',
                headers: {
                    'pinata_api_key': '3edcfb989ad2b8a716f9',  
                    'pinata_secret_api_key': 'bdce1163f7b4acfaa9f4b7bc4f1885cea4f95753238cf18052aba3a295a9daf9'
                },
                body: formData,
            });

            if (response.ok) {
                const data = await response.json();
                const cid = data.IpfsHash;
                alert(`CID: ${cid}`);
            } else {
                alert('Error uploading file to IPFS.');       
                return;
            }
        }

</script>
</head>
<body onload="init()">
<div id="drop_zone">
    Drop image file here
</div>
</body>
<hr>

</body>

</html>